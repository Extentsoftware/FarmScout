<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="FarmScout.Views.DashboardPage"
             x:DataType="viewmodels:DashboardViewModel"
             xmlns:viewmodels="clr-namespace:FarmScout.ViewModels"
             Title="{Binding Title}">
    
    <Grid RowDefinitions="*,Auto">
        <ScrollView Grid.Row="0">
            <VerticalStackLayout Spacing="20" Padding="20">
                
                <!-- Header -->
                <Label Text="ðŸŒ¾ FarmScout Dashboard" 
                       FontSize="24" 
                       FontAttributes="Bold" 
                       HorizontalOptions="Center"
                       TextColor="#2E7D32"/>
                
                <!-- Quick Stats -->
                <Frame BackgroundColor="#E8F5E8" CornerRadius="10" Padding="15">
                    <Grid ColumnDefinitions="*,*,*" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0" HorizontalOptions="Center">
                            <Label Text="{Binding TotalObservations}" 
                                   FontSize="24" 
                                   FontAttributes="Bold"
                                   TextColor="#2E7D32"/>
                            <Label Text="Observations" 
                                   FontSize="12" 
                                   TextColor="#666"/>
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Column="1" HorizontalOptions="Center">
                            <Label Text="{Binding TotalTasks}" 
                                   FontSize="24" 
                                   FontAttributes="Bold"
                                   TextColor="#1976D2"/>
                            <Label Text="Tasks" 
                                   FontSize="12" 
                                   TextColor="#666"/>
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Column="2" HorizontalOptions="Center">
                            <Label Text="{Binding AverageSoilMoisture, StringFormat='{0:F0}%'}" 
                                   FontSize="24" 
                                   FontAttributes="Bold"
                                   TextColor="#FF9800"/>
                            <Label Text="Avg Soil" 
                                   FontSize="12" 
                                   TextColor="#666"/>
                        </VerticalStackLayout>
                    </Grid>
                </Frame>
                
                <!-- Quick Actions -->
                <Frame BackgroundColor="#F5F5F5" CornerRadius="10" Padding="15">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="ðŸš€ Quick Actions" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="#2E7D32"/>
                        
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                            <Button Text="ðŸ“ New Observation" 
                                    Command="{Binding NavigateToAddObservationCommand}"
                                    BackgroundColor="#4CAF50"
                                    TextColor="White"
                                    CornerRadius="8"
                                    HeightRequest="50"/>
                            
                            <Button Text="ðŸ“‹ View All" 
                                    Command="{Binding NavigateToObservationsCommand}"
                                    BackgroundColor="#2196F3"
                                    TextColor="White"
                                    CornerRadius="8"
                                    HeightRequest="50"/>
                        </Grid>
                        
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                            <Button Text="âœ… Tasks" 
                                    Command="{Binding NavigateToTasksCommand}"
                                    BackgroundColor="#FF9800"
                                    TextColor="White"
                                    CornerRadius="8"
                                    HeightRequest="50"/>
                            
                            <Button Text="ðŸ”„ Refresh" 
                                    Command="{Binding RefreshCommand}"
                                    BackgroundColor="#9C27B0"
                                    TextColor="White"
                                    CornerRadius="8"
                                    HeightRequest="50"/>
                        </Grid>
                    </VerticalStackLayout>
                </Frame>
                
                <!-- Recent Observations -->
                <Frame BackgroundColor="#F5F5F5" CornerRadius="10" Padding="15">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="ðŸ“Š Recent Observations" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="#2E7D32"/>
                        
                        <CollectionView ItemsSource="{Binding RecentObservations}" 
                                      HeightRequest="200">
                            <CollectionView.ItemTemplate>
                                <DataTemplate x:DataType="viewmodels:ObservationViewModel">
                                    <Frame Margin="5" 
                                           BackgroundColor="White" 
                                           CornerRadius="8" 
                                           Padding="10">
                                        <Grid ColumnDefinitions="*,Auto">
                                            <VerticalStackLayout Grid.Column="0" Spacing="5">
                                                <Label Text="{Binding ObservationTypesText}" 
                                                       FontAttributes="Bold" 
                                                       FontSize="14"/>
                                                <Label Text="{Binding TimestampText}" 
                                                       FontSize="12" 
                                                       TextColor="#666"/>
                                            </VerticalStackLayout>
                                            <Button Grid.Column="1" 
                                                    Text="ðŸ‘ï¸" 
                                                    BackgroundColor="#1976D2" 
                                                    TextColor="White"
                                                    CornerRadius="15"
                                                    WidthRequest="30"
                                                    HeightRequest="30"
                                                    Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.ViewObservationCommand}"
                                                    CommandParameter="{Binding}"/>
                                        </Grid>
                                    </Frame>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </Frame>
                
            </VerticalStackLayout>
        </ScrollView>
        
        <!-- Floating Action Button -->
        <Button Grid.Row="1"
                Text="âž•"
                FontSize="24"
                BackgroundColor="#4CAF50"
                TextColor="White"
                CornerRadius="30"
                WidthRequest="60"
                HeightRequest="60"
                Margin="20"
                HorizontalOptions="End"
                VerticalOptions="End"
                Command="{Binding NavigateToAddObservationCommand}"/>
    </Grid>
</ContentPage> 