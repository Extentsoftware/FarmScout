<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="FarmScout.Views.ObservationsPage"
             x:DataType="viewmodels:ObservationsViewModel"
             xmlns:viewmodels="clr-namespace:FarmScout.ViewModels"
             Title="{Binding Title}" 
             Shell.NavBarIsVisible="True"
             Shell.PresentationMode="ModalAnimated">
    
    <Grid RowDefinitions="Auto,*">
        <!-- Header -->
        <Border Grid.Row="0" 
               BackgroundColor="#E8F5E8" 
               Padding="5,5">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <Button Grid.Column="0"
                        Text="â† Back"
                        Command="{Binding GoBackCommand}"
                        BackgroundColor="#666"
                        TextColor="White"
                        CornerRadius="8"
                        Padding="10,8"/>
                <Label Grid.Column="1"
                       Text="ðŸ“‹ All Observations" 
                       FontSize="14" 
                       FontAttributes="Bold" 
                       HorizontalOptions="Center"
                       TextColor="#2E7D32"/>
                <Button Grid.Column="2"
                        Text="ðŸ“ Add"
                        Command="{Binding AddObservationCommand}"
                        BackgroundColor="#4CAF50"
                        TextColor="White"
                        CornerRadius="8"
                        Padding="10,8"/>
            </Grid>
        </Border>
        
        <!-- Observations List -->
        <RefreshView Grid.Row="1" Command="{Binding RefreshCommand}" IsRefreshing="{Binding IsBusy}">
            <CollectionView ItemsSource="{Binding Observations}">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="viewmodels:SimpleObservationViewModel">
                        <Border Margin="10,5" 
                               BackgroundColor="White" 
                               Padding="5">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="10" />
                            </Border.StrokeShape>
                            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="15">
                                <!-- Photo placeholder -->
                                <Border Grid.Column="0" 
                                       BackgroundColor="#F5F5F5" 
                                       WidthRequest="80" 
                                       HeightRequest="80"
                                       >
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="5" />
                                    </Border.StrokeShape>
                                    <Label Text="ðŸ“·" 
                                           FontSize="24" 
                                           HorizontalOptions="Center" 
                                           VerticalOptions="Center"/>
                                </Border>
                                
                                <!-- Details -->
                                <VerticalStackLayout Grid.Column="1" Spacing="5">
                                    <Label Text="{Binding ObservationTypesText}" 
                                           FontAttributes="Bold" 
                                           FontSize="16"/>
                                    <Label Text="{Binding SeverityText}" 
                                           FontSize="14" 
                                           TextColor="{Binding SeverityColor}"
                                           FontAttributes="Bold"/>
                                    <Label Text="{Binding Notes}" 
                                           FontSize="14" 
                                           TextColor="#666"/>
                                    <Label Text="{Binding TimestampText}" 
                                           FontSize="12" 
                                           TextColor="#999"/>
                                    <Label Text="{Binding LocationText}" 
                                           FontSize="12" 
                                           TextColor="#999"/>
                                </VerticalStackLayout>
                                
                                <!-- Actions -->
                                <VerticalStackLayout Grid.Column="2" Spacing="5">
                                    
                                    <Button Text="ðŸ‘ï¸" 
                                            BackgroundColor="#1976D2" 
                                            TextColor="White"
                                            CornerRadius="15"
                                            WidthRequest="30"
                                            HeightRequest="30"
                                            Command="{Binding x:DataType=viewmodels:ObservationsViewModel, Source={RelativeSource AncestorType={x:Type viewmodels:ObservationsViewModel}}, Path=ViewDetailsCommand}"
                                            CommandParameter="{Binding .}"  
                                            />
                                    <Button Text="âŒ" 
                                            BackgroundColor="Red" 
                                            TextColor="White"
                                            CornerRadius="15"
                                            WidthRequest="30"
                                            HeightRequest="30"
                                            Command="{Binding  x:DataType=viewmodels:ObservationsViewModel, Source={RelativeSource AncestorType={x:Type viewmodels:ObservationsViewModel}}, Path=DeleteObservationCommand}"
                                            CommandParameter="{Binding .}"/>
                                </VerticalStackLayout>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </RefreshView>
    </Grid>
</ContentPage> 